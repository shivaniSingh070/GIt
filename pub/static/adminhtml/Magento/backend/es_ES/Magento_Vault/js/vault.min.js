define(['jquery','uiComponent'],function($,Class){'use strict';return Class.extend({defaults:{$selector:null,selector:'edit_form',fieldset:'',active:false,imports:{onActiveChange:'active'}},initObservable:function(){var self=this,paymentSelector='[name="payment[method]"][value="'+this.getCode()+'"]:checked';self.$selector=$('#'+self.selector);this._super().observe(['active']);if(self.$selector.find(paymentSelector).length!==0){this.active(true);}
$('#'+self.fieldset).find('[name="payment[token_switcher]"]').on('click',this.rememberTokenSwitcher.bind(this));self.$selector.off('changePaymentMethod.'+this.getCode()).on('changePaymentMethod.'+this.getCode(),this.changePaymentMethod.bind(this));if(this.active()){this.chooseTokenSwitcher();}
return this;},changePaymentMethod:function(event,method){this.active(method===this.getCode());return this;},rememberTokenSwitcher:function(event){$('#'+this.selector).data('lastTokenSwitcherId',event.target.id);return this;},chooseTokenSwitcher:function(){var lastTokenSwitcherId=$('#'+this.selector).data('lastTokenSwitcherId');if(lastTokenSwitcherId){$('#'+lastTokenSwitcherId).trigger('click');}else{$('#'+this.fieldset+' input:radio:first').trigger('click');}
return this;},onActiveChange:function(isActive){if(!isActive){this.$selector.trigger('setVaultNotActive.'+this.getCode());return;}
this.chooseTokenSwitcher();window.order.addExcludedPaymentMethod(this.getCode());},getCode:function(){return this.code;}});});