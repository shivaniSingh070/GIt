define(['jquery','underscore','uiComponent','Magento_MediaGalleryUi/js/action/getDetails'],function($,_,Component,getDetails){'use strict';return Component.extend({defaults:{template:'Magento_MediaGalleryUi/image/image-details',modalSelector:'',modalWindowSelector:'',imageDetailsUrl:'/media_gallery/image/details',images:[],tagListLimit:7,showAllTags:false,image:null,modules:{mediaGridMessages:'${ $.mediaGridMessages }'}},initObservable:function(){this._super().observe(['image','showAllTags']);return this;},showImageDetailsById:function(imageId){if(_.isUndefined(this.images[imageId])){getDetails(this.imageDetailsUrl,[imageId]).then(function(imageDetails){this.images[imageId]=imageDetails[imageId];this.image(this.images[imageId]);this.openImageDetailsModal();}.bind(this)).fail(function(error){this.addMediaGridMessage('error',error);}.bind(this));return;}
if(this.image()&&this.image().id===imageId){this.openImageDetailsModal();return;}
this.image(this.images[imageId]);this.openImageDetailsModal();},openImageDetailsModal:function(){var modalElement=$(this.modalSelector);if(!modalElement.length||_.isUndefined(modalElement.modal)){return;}
this.showAllTags(false);modalElement.modal('openModal');},closeImageDetailsModal:function(){var modalElement=$(this.modalSelector);if(!modalElement.length||_.isUndefined(modalElement.modal)){return;}
modalElement.modal('closeModal');},addMediaGridMessage:function(code,message){this.mediaGridMessages().add(code,message);this.mediaGridMessages().scheduleCleanup();},getTagText:function(tagText,tagIndex){return tagText+(this.image().tags.length-1===tagIndex?'':',');},showMoreImageTags:function(){this.showAllTags(true);},isArray:function(value){return _.isArray(value);},notEmpty:function(value){return value.length>0;},getUsedInText:function(item){return item.name+'('+item.number+')';},getFilterUrl:function(link){return link+'?filters[asset_id]=['+this.image().id+']';},isActive:function(){return $(this.modalWindowSelector).hasClass('_show');},removeCached:function(id){delete this.images[id];}});});