function _createForOfIteratorHelperLoose(o,allowArrayLike){var it=typeof Symbol!=="undefined"&&o[Symbol.iterator]||o["@@iterator"];if(it)return(it=it.call(o)).next.bind(it);if(Array.isArray(o)||(it=_unsupportedIterableToArray(o))||allowArrayLike&&o&&typeof o.length==="number"){if(it)o=it;var i=0;return function(){if(i>=o.length)return{done:true};return{done:false,value:o[i++]};};}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}
function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen);}
function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i];}return arr2;}
function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return self;}
function _inheritsLoose(subClass,superClass){subClass.prototype=Object.create(superClass.prototype);subClass.prototype.constructor=subClass;_setPrototypeOf(subClass,superClass);}
function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o;};return _setPrototypeOf(o,p);}
define(["jquery","knockout","mage/translate","Magento_PageBuilder/js/events","underscore","Magento_PageBuilder/js/config","Magento_PageBuilder/js/drag-drop/move-content-type","Magento_PageBuilder/js/drag-drop/registry","Magento_PageBuilder/js/drag-drop/sortable","Magento_PageBuilder/js/utils/check-stage-full-screen","Magento_PageBuilder/js/utils/create-stylesheet","Magento_PageBuilder/js/utils/pagebuilder-header-height","Magento_PageBuilder/js/content-type/column/resize","Magento_PageBuilder/js/content-type/preview-collection","Magento_PageBuilder/js/content-type/column-group/drag-and-drop","Magento_PageBuilder/js/content-type/column-group/factory","Magento_PageBuilder/js/content-type/column-group/grid-size","Magento_PageBuilder/js/content-type/column-group/registry"],function(_jquery,_knockout,_translate,_events,_underscore,_config,_moveContentType,_registry,_sortable,_checkStageFullScreen,_createStylesheet,_pagebuilderHeaderHeight,_resize,_previewCollection,_dragAndDrop,_factory,_gridSize,_registry2){function _getRequireWildcardCache(nodeInterop){if(typeof WeakMap!=="function")return null;var cacheBabelInterop=new WeakMap();var cacheNodeInterop=new WeakMap();return(_getRequireWildcardCache=function _getRequireWildcardCache(nodeInterop){return nodeInterop?cacheNodeInterop:cacheBabelInterop;})(nodeInterop);}
var Preview=function(_previewCollection2){"use strict";_inheritsLoose(Preview,_previewCollection2);function Preview(contentType,config,observableUpdater){var _this;_this=_previewCollection2.call(this,contentType,config,observableUpdater)||this;_this.resizing=_knockout.observable(false);_this.hasEmptyChild=_knockout.computed(function(){var empty=false;_this.contentType.getChildren()().forEach(function(column){if(column.getChildren()().length===0){empty=true;}});return empty;});_this.gridSize=_knockout.observable();_this.gridSizeInput=_knockout.observable();_this.gridSizeArray=_knockout.observableArray([]);_this.gridSizeError=_knockout.observable();_this.gridSizeMax=_knockout.observable((0,_gridSize.getMaxGridSize)());_this.gridFormOpen=_knockout.observable(false);_this.gridChange=_knockout.observable(false);_this.gridToolTipOverFlow=_knockout.observable(false);_this.resizeColumnWidths=[];_this.resizeHistory={left:[],right:[]};_this.dropPositions=[];_this.gridSizeHistory=new Map();_this.interactionLevel=0;_this.onDocumentClick=function(event){if(!_jquery.contains((0,_jquery)(_this.wrapperElement).find(".pagebuilder-grid-size-indicator")[0],(0,_jquery)(event.target)[0])){_this.closeGridForm();}};_this.resizeUtils=new _resize(_this.contentType);_this.contentType.dataStore.subscribe(function(state){var gridSize=parseInt(state.grid_size.toString(),10);_this.gridSize(gridSize);_this.gridSizeInput(gridSize);if(gridSize){_this.gridSizeArray(new Array(gridSize));}},"grid_size");_events.on("contentType:removeAfter",function(args){if(args.parentContentType&&args.parentContentType.id===_this.contentType.id){_underscore.defer(function(){_this.spreadWidth(args.index);});}});_events.on("column:resizeHandleBindAfter",function(args){if(args.columnGroup.id===_this.contentType.id){_this.registerResizeHandle(args.column,args.handle);}});_events.on("column:initializeAfter",function(args){if(args.columnGroup.id===_this.contentType.id){_this.bindDraggable(args.column);}});_this.contentType.children.subscribe(_underscore.debounce(_this.removeIfEmpty.bind(_assertThisInitialized(_this)),50));return _this;}
var _proto=Preview.prototype;_proto.getResizeUtils=function getResizeUtils(){return this.resizeUtils;};_proto.onNewColumnDrop=function onNewColumnDrop(dropPosition){var _this2=this;(0,_factory.createColumn)(this.contentType,this.resizeUtils.getSmallestColumnWidth(),dropPosition.insertIndex).then(function(){var newWidth=_this2.resizeUtils.getAcceptedColumnWidth((_this2.resizeUtils.getColumnWidth(dropPosition.affectedColumn)-_this2.resizeUtils.getSmallestColumnWidth()).toString());(0,_resize.updateColumnWidth)(dropPosition.affectedColumn,newWidth);});};_proto.onExistingColumnDrop=function onExistingColumnDrop(movePosition){var column=(0,_registry2.getDragColumn)();var sourceGroupPreview=column.parentContentType.preview;var modifyOldNeighbour;var oldWidth=sourceGroupPreview.getResizeUtils().getColumnWidth(column);if((0,_resize.getAdjacentColumn)(column,"+1")){modifyOldNeighbour=(0,_resize.getAdjacentColumn)(column,"+1");}else if((0,_resize.getAdjacentColumn)(column,"-1")){modifyOldNeighbour=(0,_resize.getAdjacentColumn)(column,"-1");}
(0,_resize.updateColumnWidth)(column,this.resizeUtils.getSmallestColumnWidth());(0,_moveContentType.moveContentType)(column,movePosition.insertIndex,this.contentType);if(modifyOldNeighbour){var oldNeighbourWidth=sourceGroupPreview.getResizeUtils().getAcceptedColumnWidth((oldWidth+sourceGroupPreview.getResizeUtils().getColumnWidth(modifyOldNeighbour)).toString());(0,_resize.updateColumnWidth)(modifyOldNeighbour,oldNeighbourWidth);}
var newNeighbourWidth=this.resizeUtils.getAcceptedColumnWidth((this.resizeUtils.getColumnWidth(movePosition.affectedColumn)-this.resizeUtils.getSmallestColumnWidth()).toString());(0,_resize.updateColumnWidth)(movePosition.affectedColumn,newNeighbourWidth);};_proto.onColumnSort=function onColumnSort(column,newIndex){var currentIndex=(0,_resize.getColumnIndexInGroup)(column);if(currentIndex!==newIndex){if(currentIndex<newIndex){--newIndex;}
(0,_moveContentType.moveContentType)(column,newIndex);}};_proto.onColumnResize=function onColumnResize(column,width,adjustedColumn){this.resizeUtils.resizeColumn(column,width,adjustedColumn);};_proto.bindInteractions=function bindInteractions(group){this.groupElement=(0,_jquery)(group);this.initDroppable(this.groupElement);this.initMouseMove(this.groupElement);(0,_jquery)("body").mouseleave(this.endAllInteractions.bind(this));};_proto.bindDropPlaceholder=function bindDropPlaceholder(element){this.dropPlaceholder=(0,_jquery)(element);};_proto.bindMovePlaceholder=function bindMovePlaceholder(element){this.movePlaceholder=(0,_jquery)(element);};_proto.bindGhost=function bindGhost(ghost){this.resizeGhost=(0,_jquery)(ghost);};_proto.registerResizeHandle=function registerResizeHandle(column,handle){var _this3=this;handle.off("mousedown touchstart");handle.on("mousedown touchstart",function(event){event.preventDefault();var groupPosition=_this3.getGroupPosition(_this3.groupElement);_this3.resizing(true);_this3.resizeColumnInstance=column;_this3.resizeColumnWidths=_this3.resizeUtils.determineColumnWidths(_this3.resizeColumnInstance,groupPosition);_this3.resizeMaxGhostWidth=(0,_resize.determineMaxGhostWidth)(_this3.resizeColumnWidths);(0,_jquery)("body").css("cursor","col-resize");_this3.resizeHistory={left:[],right:[]};_this3.resizeLastPosition=null;_this3.resizeMouseDown=true;++_this3.interactionLevel;_events.trigger("stage:interactionStart",{stageId:_this3.contentType.stageId});});};_proto.bindDraggable=function bindDraggable(column){var _this4=this;column.preview.element.draggable({appendTo:"body",containment:"body",cursor:"-webkit-grabbing",handle:".move-column",revertDuration:250,helper:function helper(){var helper=(0,_jquery)(this).clone();helper.css({height:(0,_jquery)(this).outerHeight()+"px",minHeight:0,opacity:0.5,pointerEvents:"none",width:(0,_jquery)(this).outerWidth()+"px",zIndex:5000});return helper;},start:function start(event){var columnInstance=_knockout.dataFor((0,_jquery)(event.target)[0]);(0,_registry2.setDragColumn)(columnInstance.contentType);_this4.dropPositions=(0,_dragAndDrop.calculateDropPositions)(_this4.contentType);_this4.startDragEvent=event;_events.trigger("column:dragStart",{column:columnInstance,stageId:_this4.contentType.stageId});_events.trigger("stage:interactionStart",{stageId:_this4.contentType.stageId});},stop:function stop(){var draggedColumn=(0,_registry2.getDragColumn)();if(_this4.movePosition&&draggedColumn){if(draggedColumn.parentContentType===_this4.contentType){_this4.onColumnSort(draggedColumn,_this4.movePosition.insertIndex);_this4.movePosition=null;}}
(0,_registry2.removeDragColumn)();_this4.dropPlaceholder.removeClass("left right");_this4.movePlaceholder.removeClass("active");_this4.startDragEvent=null;_events.trigger("column:dragStop",{column:draggedColumn,stageId:_this4.contentType.stageId});_events.trigger("stage:interactionStop",{stageId:_this4.contentType.stageId});}});};_proto.updateGridSize=function updateGridSize(){var _this5=this;if(!_jquery.isNumeric(this.gridSizeInput())){this.gridSizeError((0,_translate)("Please enter a valid number."));}
var newGridSize=parseInt(this.gridSizeInput().toString(),10);if(newGridSize||newGridSize===0){if(newGridSize!==this.resizeUtils.getGridSize()){try{(0,_gridSize.resizeGrid)(this.contentType,newGridSize,this.gridSizeHistory);this.recordGridResize(newGridSize);this.gridSizeError(null);this.gridChange(true);_underscore.delay(function(){_this5.gridChange(false);},1000);}catch(e){if(e instanceof _gridSize.GridSizeError){this.gridSizeError(e.message);}else{throw e;}}}else{this.gridSizeError(null);}}};_proto.onGridInputKeyUp=function onGridInputKeyUp(context,event){if(event.which===13||event.keyCode===13){this.updateGridSize();}};_proto.onGridInputBlur=function onGridInputBlur(){this.updateGridSize();};_proto.closeGridForm=function closeGridForm(){this.updateGridSize();if(!this.gridSizeError()){this.gridFormOpen(false);this.gridToolTipOverFlow(false);_events.trigger("stage:interactionStop");_events.trigger("stage:childFocusStop");(0,_jquery)(document).off("click focusin",this.onDocumentClick);}};_proto.openGridForm=function openGridForm(){var _this6=this;var tooltip=(0,_jquery)(this.wrapperElement).find("[role='tooltip']");if(!this.gridFormOpen()){this.gridSizeHistory=new Map();this.recordGridResize(this.gridSize());var tooltipClientRectTop=tooltip[0].getBoundingClientRect().top-(0,_pagebuilderHeaderHeight)(this.contentType.stageId);if((0,_checkStageFullScreen)(this.contentType.stageId)&&tooltip[0].getBoundingClientRect().height>tooltipClientRectTop){this.gridToolTipOverFlow(true);}
this.gridFormOpen(true);_underscore.delay(function(){(0,_jquery)(_this6.wrapperElement).find(".grid-panel-item-wrapper input").focus().select();},200);(0,_jquery)(document).on("click focusin",this.onDocumentClick);_events.trigger("stage:interactionStart");_events.trigger("stage:childFocusStart");}};_proto.setColumnsAsResizing=function setColumnsAsResizing(){for(var _len=arguments.length,columns=new Array(_len),_key=0;_key<_len;_key++){columns[_key]=arguments[_key];}
columns.forEach(function(column){column.preview.resizing(true);column.preview.element.css({transition:"width 350ms ease-in-out"});});};_proto.unsetResizingColumns=function unsetResizingColumns(){this.contentType.children().forEach(function(column){column.preview.resizing(false);if(column.preview.element){column.preview.element.css({transition:""});}});};_proto.endAllInteractions=function endAllInteractions(){if(this.resizing()===true){for(;this.interactionLevel>0;this.interactionLevel--){_events.trigger("stage:interactionStop",{stageId:this.contentType.stageId});}}
this.resizing(false);this.resizeMouseDown=null;this.resizeLeftLastColumnShrunk=this.resizeRightLastColumnShrunk=null;this.dropPositions=[];this.unsetResizingColumns();(0,_jquery)("body").css("cursor","");this.dropPlaceholder.removeClass("left right");this.movePlaceholder.css("left","").removeClass("active");this.resizeGhost.removeClass("active");this.groupPositionCache=null;};_proto.initMouseMove=function initMouseMove(group){var _this7=this;var intersects=false;(0,_jquery)(document).on("mousemove touchmove",function(event){if(group.parents(_sortable.hiddenClass).length>0){return;}
var groupPosition=_this7.getGroupPosition(group);if(event.type==="touchmove"){event.pageX=event.originalEvent.pageX;event.pageY=event.originalEvent.pageY;}
if(_this7.eventIntersectsGroup(event,groupPosition)){intersects=true;_this7.onResizingMouseMove(event,group,groupPosition);_this7.onDraggingMouseMove(event,group,groupPosition);_this7.onDroppingMouseMove(event,group,groupPosition);}else{intersects=false;_this7.groupPositionCache=null;_this7.dropPosition=null;_this7.dropPlaceholder.removeClass("left right");_this7.movePlaceholder.css("left","").removeClass("active");}}).on("mouseup touchend",function(){if(intersects){_this7.handleMouseUp();}
intersects=false;_this7.dropPosition=null;_this7.endAllInteractions();_underscore.defer(function(){group.find(".ui-sortable").each(function(){if((0,_jquery)(this).data("sortable")){(0,_jquery)(this).sortable("option","disabled",false);}});});});};_proto.handleMouseUp=function handleMouseUp(){if(this.dropOverElement&&this.dropPosition){this.onNewColumnDrop(this.dropPosition);this.dropOverElement=null;_underscore.defer(function(){(0,_jquery)(".element-children.ui-sortable-disabled").each(function(){(0,_jquery)(this).sortable("option","disabled",false);});});}
var column=(0,_registry2.getDragColumn)();if(this.movePosition&&column&&column.parentContentType!==this.contentType){this.onExistingColumnDrop(this.movePosition);}};_proto.eventIntersectsGroup=function eventIntersectsGroup(event,groupPosition){return event.pageY>groupPosition.top&&event.pageY<groupPosition.top+groupPosition.outerHeight&&event.pageX>groupPosition.left&&event.pageX<groupPosition.left+groupPosition.outerWidth;};_proto.getGroupPosition=function getGroupPosition(group){if(!this.groupPositionCache){this.groupPositionCache={top:group.offset().top,left:group.offset().left,width:group.width(),height:group.height(),outerWidth:group.outerWidth(),outerHeight:group.outerHeight()};}
return this.groupPositionCache;};_proto.recordResizeHistory=function recordResizeHistory(usedHistory,direction,adjustedColumn,modifyColumnInPair){if(usedHistory){this.resizeHistory[usedHistory].pop();}
this.resizeHistory[direction].push({adjustedColumn:adjustedColumn,modifyColumnInPair:modifyColumnInPair});};_proto.onResizingMouseMove=function onResizingMouseMove(event,group,groupPosition){var _this8=this;var newColumnWidth;if(this.resizeMouseDown){event.preventDefault();var currentPos=event.pageX;var resizeColumnLeft=this.resizeColumnInstance.preview.element.offset().left;var resizeColumnWidth=this.resizeColumnInstance.preview.element.outerWidth();var resizeHandlePosition=resizeColumnLeft+resizeColumnWidth;var direction=currentPos>=resizeHandlePosition?"right":"left";var adjustedColumn;var modifyColumnInPair;var usedHistory;var _this$resizeUtils$det=this.resizeUtils.determineAdjustedColumn(currentPos,this.resizeColumnInstance,this.resizeHistory);adjustedColumn=_this$resizeUtils$det[0];modifyColumnInPair=_this$resizeUtils$det[1];usedHistory=_this$resizeUtils$det[2];var ghostWidth=this.resizeUtils.calculateGhostWidth(groupPosition,currentPos,this.resizeColumnInstance,modifyColumnInPair,this.resizeMaxGhostWidth);this.resizeGhost.width(ghostWidth-15+"px").addClass("active");if(adjustedColumn&&this.resizeColumnWidths){newColumnWidth=this.resizeColumnWidths.find(function(val){return(0,_resize.comparator)(currentPos,val.position,35)&&val.forColumn===modifyColumnInPair;});if(newColumnWidth){var mainColumn=this.resizeColumnInstance;if(modifyColumnInPair==="right"){mainColumn=(0,_resize.getAdjacentColumn)(this.resizeColumnInstance,"+1");}
if(this.resizeUtils.getColumnWidth(mainColumn)!==newColumnWidth.width&&!(0,_resize.comparator)(this.resizeLastPosition,newColumnWidth.position,10)){if(usedHistory&&this.resizeLastColumnInPair==="right"&&direction==="right"&&newColumnWidth.forColumn==="left"){var originalMainColumn=mainColumn;mainColumn=adjustedColumn;adjustedColumn=(0,_resize.getAdjacentColumn)(originalMainColumn,"+1");}
this.recordResizeHistory(usedHistory,direction,adjustedColumn,modifyColumnInPair);this.resizeLastPosition=newColumnWidth.position;this.resizeLastColumnInPair=modifyColumnInPair;this.setColumnsAsResizing(mainColumn,adjustedColumn);this.onColumnResize(mainColumn,newColumnWidth.width,adjustedColumn);_underscore.defer(function(){_this8.resizeColumnWidths=_this8.resizeUtils.determineColumnWidths(_this8.resizeColumnInstance,groupPosition);_this8.resizeMaxGhostWidth=(0,_resize.determineMaxGhostWidth)(_this8.resizeColumnWidths);});}}}}};_proto.onDraggingMouseMove=function onDraggingMouseMove(event,group,groupPosition){var dragColumn=(0,_registry2.getDragColumn)();if(dragColumn){if(this.dropPositions.length===0){this.dropPositions=(0,_dragAndDrop.calculateDropPositions)(this.contentType);}
var columnInstance=dragColumn;var currentX=event.pageX-groupPosition.left;if(columnInstance.parentContentType===this.contentType&&this.startDragEvent){var dragDirection=event.pageX<=this.startDragEvent.pageX?"left":"right";var adjacentLeftColumn=(0,_resize.getAdjacentColumn)(dragColumn,"-1");this.movePosition=this.dropPositions.find(function(position){return currentX>position.left&&currentX<position.right&&position.placement===dragDirection&&position.affectedColumn!==dragColumn;});if(this.movePosition&&dragDirection==="right"&&this.movePosition.affectedColumn===adjacentLeftColumn){this.movePosition=null;}
if(this.movePosition){this.dropPlaceholder.removeClass("left right");this.movePlaceholder.css({left:this.movePosition.placement==="left"?this.movePosition.left:"",right:this.movePosition.placement==="right"?groupPosition.width-this.movePosition.right:"",width:dragColumn.preview.element.outerWidth()+"px"}).addClass("active");}else{this.movePlaceholder.removeClass("active");}}else{this.movePosition=this.dropPositions.find(function(position){return currentX>position.left&&currentX<=position.right&&position.canShrink;});if(this.movePosition){var classToRemove=this.movePosition.placement==="left"?"right":"left";this.movePlaceholder.removeClass("active");this.dropPlaceholder.removeClass(classToRemove).css({left:this.movePosition.placement==="left"?this.movePosition.left:"",right:this.movePosition.placement==="right"?groupPosition.width-this.movePosition.right:"",width:groupPosition.width / this.resizeUtils.getGridSize()+"px"}).addClass(this.movePosition.placement);}else{this.dropPlaceholder.removeClass("left right");}}}};_proto.onDroppingMouseMove=function onDroppingMouseMove(event,group,groupPosition){var elementChildrenParent=group.parents(".element-children");if(this.dropOverElement&&event.pageY>groupPosition.top+20&&event.pageY<groupPosition.top+groupPosition.outerHeight-20){if(elementChildrenParent.data("sortable")){elementChildrenParent.sortable("option","disabled",true);}
var currentX=event.pageX-groupPosition.left;this.dropPosition=this.dropPositions.find(function(position){return currentX>position.left&&currentX<=position.right&&position.canShrink;});if(this.dropPosition){this.dropPlaceholder.removeClass("left right").css({left:this.dropPosition.placement==="left"?this.dropPosition.left:"",right:this.dropPosition.placement==="right"?groupPosition.width-this.dropPosition.right:"",width:groupPosition.width / this.resizeUtils.getGridSize()+"px"}).addClass(this.dropPosition.placement);}}else if(this.dropOverElement){if(elementChildrenParent.data("sortable")){elementChildrenParent.sortable("option","disabled",false);}
this.dropPosition=null;this.dropPlaceholder.removeClass("left right");}};_proto.initDroppable=function initDroppable(group){var self=this;var headStyles;group.droppable({deactivate:function deactivate(){self.dropOverElement=null;self.dropPlaceholder.removeClass("left right");_underscore.defer(function(){group.parents(".element-children").each(function(){if((0,_jquery)(this).data("sortable")){(0,_jquery)(this).sortable("option","disabled",false);}});});},activate:function activate(){if((0,_registry.getDraggedContentTypeConfig)()===_config.getContentTypeConfig("column")){var _ref;group.find(".ui-sortable").each(function(){if((0,_jquery)(this).data("sortable")){(0,_jquery)(this).sortable("option","disabled",true);}});var classes=[".pagebuilder-content-type.pagebuilder-column .pagebuilder-drop-indicator",".pagebuilder-content-type.pagebuilder-column .empty-container .content-type-container:before"];headStyles=(0,_createStylesheet.createStyleSheet)((_ref={},_ref[classes.join(", ")]={display:"none!important"},_ref));document.head.appendChild(headStyles);}else if(headStyles){headStyles.remove();headStyles=null;}},drop:function drop(){self.dropPositions=[];self.dropPlaceholder.removeClass("left right");},out:function out(){self.dropOverElement=null;self.dropPlaceholder.removeClass("left right");},over:function over(){if((0,_registry.getDraggedContentTypeConfig)()===_config.getContentTypeConfig("column")){self.dropPositions=(0,_dragAndDrop.calculateDropPositions)(self.contentType);self.dropOverElement=true;}else{self.dropOverElement=null;}}});};_proto.spreadWidth=function spreadWidth(removedIndex){if(this.contentType.children().length===0){return;}
var availableWidth=100-this.resizeUtils.getColumnsWidth();var formattedAvailableWidth=(0,_resize.getRoundedColumnWidth)(availableWidth);var totalChildColumns=this.contentType.children().length;var allowedColumnWidths=[];var spreadAcross=1;var spreadAmount;for(var i=this.resizeUtils.getGridSize();i>0;i--){allowedColumnWidths.push((0,_resize.getRoundedColumnWidth)(100 / this.resizeUtils.getGridSize()*i));}
for(var _i=totalChildColumns;_i>0;_i--){var potentialWidth=Math.floor(formattedAvailableWidth / _i);for(var _iterator=_createForOfIteratorHelperLoose(allowedColumnWidths),_step;!(_step=_iterator()).done;){var width=_step.value;if(potentialWidth===Math.floor(width)){spreadAcross=_i;spreadAmount=formattedAvailableWidth / _i;break;}}
if(spreadAmount){break;}}
for(var _i2=1;_i2<=spreadAcross;_i2++){var columnToModify=void 0;if(removedIndex<=this.contentType.children().length&&typeof this.contentType.children()[removedIndex]!=="undefined"){columnToModify=this.contentType.children()[removedIndex];}
if(!columnToModify&&removedIndex-_i2>=0&&typeof this.contentType.children()[removedIndex-_i2]!=="undefined"){columnToModify=this.contentType.children()[removedIndex-_i2];}
if(columnToModify){(0,_resize.updateColumnWidth)(columnToModify,this.resizeUtils.getColumnWidth(columnToModify)+spreadAmount);}}};_proto.removeIfEmpty=function removeIfEmpty(){if(this.contentType.children().length===0){this.contentType.parentContentType.removeChild(this.contentType);return;}};_proto.recordGridResize=function recordGridResize(newGridSize){var _this9=this;if(!this.gridSizeHistory.has(newGridSize)){var columnWidths=[];this.contentType.getChildren()().forEach(function(column){columnWidths.push(_this9.resizeUtils.getColumnWidth(column));});this.gridSizeHistory.set(newGridSize,columnWidths);}};return Preview;}(_previewCollection);return Preview;});