define(['Magento_Checkout/js/view/payment/default','Magento_Checkout/js/model/quote','PayPal_Braintree/js/googlepay/button'],function(Component,quote,button){'use strict';return Component.extend({defaults:{template:'PayPal_Braintree/googlepay/core-checkout',paymentMethodNonce:null,deviceSupported:button.deviceSupported(),grandTotalAmount:0},getGooglePayBtn:function(id){button.init(document.getElementById(id),this);},initObservable:function(){this._super();this.grandTotalAmount=parseFloat(quote.totals()['base_grand_total']).toFixed(2);this.currencyCode=quote.totals()['base_currency_code'];quote.totals.subscribe(function(){if(this.grandTotalAmount!==quote.totals()['base_grand_total']){this.grandTotalAmount=parseFloat(quote.totals()['base_grand_total']).toFixed(2);}}.bind(this));return this;},startPlaceOrder:function(nonce,paymentData){this.setPaymentMethodNonce(nonce);this.placeOrder();},setPaymentMethodNonce:function(nonce){this.paymentMethodNonce=nonce;},getClientToken:function(){return window.checkoutConfig.payment[this.getCode()].clientToken;},getPaymentRequest:function(){var result={transactionInfo:{totalPriceStatus:'FINAL',totalPrice:this.grandTotalAmount,currencyCode:this.currencyCode},allowedPaymentMethods:['CARD'],phoneNumberRequired:false,emailRequired:false,shippingAddressRequired:false,cardRequirements:{billingAddressRequired:false,allowedCardNetworks:this.getCardTypes()}};if(this.getEnvironment()!=="TEST"){result['merchantId']=this.getMerchantId();}
return result;},getMerchantId:function(){return window.checkoutConfig.payment[this.getCode()].merchantId;},getEnvironment:function(){return window.checkoutConfig.payment[this.getCode()].environment;},getCardTypes:function(){return window.checkoutConfig.payment[this.getCode()].cardTypes;},getBtnColor:function(){return window.checkoutConfig.payment[this.getCode()].btnColor;},getData:function(){return{'method':this.getCode(),'additional_data':{'payment_method_nonce':this.paymentMethodNonce}};},getPaymentMarkSrc:function(){return window.checkoutConfig.payment[this.getCode()].paymentMarkSrc;}});});