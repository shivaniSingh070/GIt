define(['jquery','ko','uiComponent','Magento_Checkout/js/model/quote','Magento_SalesRule/js/action/set-coupon-code','Magento_SalesRule/js/action/cancel-coupon','Magento_SalesRule/js/model/coupon'],function($,ko,Component,quote,setCouponCodeAction,cancelCouponAction,coupon){'use strict';var totals=quote.getTotals(),couponCode=coupon.getCouponCode(),isApplied=coupon.getIsApplied();if(totals()){couponCode(totals()['coupon_code']);}
isApplied(couponCode()!=null);return Component.extend({defaults:{template:'Magento_SalesRule/payment/discount'},couponCode:couponCode,isApplied:isApplied,apply:function(){if(this.validate()){setCouponCodeAction(couponCode(),isApplied);}},cancel:function(){if(this.validate()){couponCode('');cancelCouponAction(isApplied);}},validate:function(){var form='#discount-form';return $(form).validation()&&$(form).validation('isValid');}});});