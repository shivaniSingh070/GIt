define(["ko","nestable"],function(ko){var initialData=[{item_id:"1",name:"Women",classes:"vc-women"},{item_id:"2",name:"Men",classes:"vc-menu"},{item_id:"3",name:"Child",classes:"vc-child"}];var nestablOptions={group:1,expandBtnHTML:'<button data-action="expand" type="button"><i class="fa fa-caret-down"></i></button>',collapseBtnHTML:'<button data-action="collapse" type="button"><i class="fa fa-caret-up"></i></button>',maxDepth:8};var updateOutput=function(e){var list=e.length?e:jQuery(e.target),output=list.data('output');if(window.JSON){output.val(window.JSON.stringify(list.nestable('serialize')));}else{output.val('JSON browser support required for this demo.');}};var Item=function(data){var self=this;var d=new Date();var id='_'+d.getTime()+'_'+d.getMilliseconds();self.name=ko.observable(data.name||"new item");self.classes=ko.observable(data.classes||"");self.item_id=ko.observable(data.item_id||id);}
Item.prototype.toJSON=function(){var copy=ko.toJS(this);delete copy.full;return copy;}
Item.prototype.update=function(data){this.name(data.name||"new item");};var MenuModel=function(items){var self=this;self.selectedItem=ko.observable();self.items=ko.observableArray(ko.utils.arrayMap(items,function(data){return new Item(data);}));self.itemForEditing=ko.observable();self.addIem=function(){var d=new Date();var id='_'+d.getTime()+'_'+d.getMilliseconds();var item=new Item([]);self.items.push(item);self.selectedItem(item);self.itemForEditing(item);updateOutput(jQuery('#nestable').data('output',jQuery('#nestable-output')));};self.removeItem=function(item){if(confirm('Are you sure you want to do this ?')){self.items.remove(item);self.firstActive();updateOutput(jQuery('#nestable').data('output',jQuery('#nestable-output')));}};self.acceptItem=function(item){var selected=self.selectedItem();var edited=ko.toJS(self.itemForEditing());selected.update(edited);self.selectedItem(null);self.itemForEditing(null);}
self.save=function(){self.lastSaveJson(JSON.stringify(ko.toJS(self.items),null,2));}
self.selectItem=function(item){self.itemForEditing(new Item(ko.toJS(item)));self.selectedItem(item);}
self.revertItem=function(){self.selectedItem(null);self.itemForEditing(null);}
self.firstActive=function(){var item=self.items()[0];if(item){self.selectedItem(item);self.itemForEditing(item);}else{self.selectedItem(false);self.itemForEditing(false);}}}
return MenuModel;});